{"ast":null,"code":"import { MongoClient } from 'mongodb';\nconst client = new MongoClient(process.env.MONGODB_URI, {\n  useNewUrlParser: true,\n  useUnifiedTopology: true\n});\n\nconst database = fn => async (req, res) => {\n  if (!client.isConnected()) {\n    await client.connect();\n  }\n\n  const db = client.db('groceriesddDB');\n  req.db = db;\n  return await fn(req, res);\n};\n\nexport { database };","map":{"version":3,"sources":["C:/Dev/Sandbox/next/next-starter/middleware/database.ts"],"names":["MongoClient","client","process","env","MONGODB_URI","useNewUrlParser","useUnifiedTopology","database","fn","req","res","isConnected","connect","db"],"mappings":"AAAA,SAASA,WAAT,QAAgC,SAAhC;AAGA,MAAMC,MAAM,GAAG,IAAID,WAAJ,CAAgBE,OAAO,CAACC,GAAR,CAAYC,WAA5B,EAAyC;AACpDC,EAAAA,eAAe,EAAE,IADmC;AAEpDC,EAAAA,kBAAkB,EAAE;AAFgC,CAAzC,CAAf;;AASA,MAAMC,QAAQ,GAAIC,EAAD,IAAwB,OAAOC,GAAP,EAA8BC,GAA9B,KAAuD;AAC5F,MAAI,CAACT,MAAM,CAACU,WAAP,EAAL,EAA2B;AACvB,UAAMV,MAAM,CAACW,OAAP,EAAN;AACH;;AAED,QAAMC,EAAE,GAAGZ,MAAM,CAACY,EAAP,CAAU,eAAV,CAAX;AACAJ,EAAAA,GAAG,CAACI,EAAJ,GAASA,EAAT;AAEA,SAAO,MAAML,EAAE,CAACC,GAAD,EAAMC,GAAN,CAAf;AAEH,CAVD;;AAYA,SAASH,QAAT","sourcesContent":["import { MongoClient, Db } from 'mongodb';\r\nimport { NextApiHandler, NextApiRequest, NextApiResponse } from 'next';\r\n\r\nconst client = new MongoClient(process.env.MONGODB_URI, {\r\n    useNewUrlParser: true,\r\n    useUnifiedTopology: true\r\n});\r\n\r\nexport interface MyNextApiRequest extends NextApiRequest {\r\n    db: Db\r\n}\r\n\r\nconst database = (fn: NextApiHandler) => async (req: MyNextApiRequest, res: NextApiResponse) => {\r\n    if (!client.isConnected()) {\r\n        await client.connect();\r\n    }\r\n\r\n    const db = client.db('groceriesddDB');\r\n    req.db = db;\r\n\r\n    return await fn(req, res);\r\n\r\n}\r\n\r\nexport { database };"]},"metadata":{},"sourceType":"module"}