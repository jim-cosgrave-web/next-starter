{"ast":null,"code":"import { verify } from 'jsonwebtoken';\n\nconst authenticate = fn => async (req, res) => {\n  //\n  // With header\n  //\n  // verify(req.headers.authorization, process.env.JWT_SECRET, async function (err, decoded) {\n  //     if (!err && decoded) {\n  //         return await fn(req, res);\n  //     }\n  //     res.status(401).json({ message: 'Sorry you are not authenticated' });\n  // });\n  //\n  // With cookie\n  //\n  verify(req.cookies.auth, process.env.JWT_SECRET, async function (err, decoded) {\n    if (!err && decoded) {\n      return await fn(req, res);\n    }\n\n    res.status(401).json({\n      message: 'Sorry you are not authenticated'\n    });\n  });\n};\n\nexport { authenticate };","map":{"version":3,"sources":["C:/Dev/Sandbox/next/next-starter/middleware/authenticate.ts"],"names":["verify","authenticate","fn","req","res","cookies","auth","process","env","JWT_SECRET","err","decoded","status","json","message"],"mappings":"AAAA,SAASA,MAAT,QAAuB,cAAvB;;AAGA,MAAMC,YAAY,GAAIC,EAAD,IAAwB,OAAOC,GAAP,EAA4BC,GAA5B,KAAqD;AAC9F;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACAJ,EAAAA,MAAM,CAACG,GAAG,CAACE,OAAJ,CAAYC,IAAb,EAAmBC,OAAO,CAACC,GAAR,CAAYC,UAA/B,EAA2C,gBAAgBC,GAAhB,EAAqBC,OAArB,EAA8B;AAC3E,QAAI,CAACD,GAAD,IAAQC,OAAZ,EAAqB;AACjB,aAAO,MAAMT,EAAE,CAACC,GAAD,EAAMC,GAAN,CAAf;AACH;;AAEDA,IAAAA,GAAG,CAACQ,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEC,MAAAA,OAAO,EAAE;AAAX,KAArB;AACH,GANK,CAAN;AAOH,CAtBD;;AAwBA,SAASb,YAAT","sourcesContent":["import { verify } from 'jsonwebtoken';\r\nimport { NextApiHandler, NextApiRequest, NextApiResponse } from 'next';\r\n\r\nconst authenticate = (fn: NextApiHandler) => async (req: NextApiRequest, res: NextApiResponse) => {\r\n    //\r\n    // With header\r\n    //\r\n    // verify(req.headers.authorization, process.env.JWT_SECRET, async function (err, decoded) {\r\n    //     if (!err && decoded) {\r\n    //         return await fn(req, res);\r\n    //     }\r\n\r\n    //     res.status(401).json({ message: 'Sorry you are not authenticated' });\r\n    // });\r\n\r\n    //\r\n    // With cookie\r\n    //\r\n    verify(req.cookies.auth, process.env.JWT_SECRET, async function (err, decoded) {\r\n        if (!err && decoded) {\r\n            return await fn(req, res);\r\n        }\r\n\r\n        res.status(401).json({ message: 'Sorry you are not authenticated' });\r\n    });\r\n}\r\n\r\nexport { authenticate };"]},"metadata":{},"sourceType":"module"}